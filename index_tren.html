<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JavaScript –¢—Ä–µ–Ω–∞–∂–µ—Ä - –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/monokai.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            height: 100vh;
            overflow: hidden;
        }

        #app {
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #1e293b;
            border-bottom: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
        }

        .progress-indicator {
            background: #334155;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 20px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            background: #475569;
            color: #fff;
        }

        .task-container {
            padding: 16px;
            background: #1e293b;
            border-bottom: 1px solid #334155;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .task-title {
            font-size: 16px;
            font-weight: 600;
        }

        .task-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }

        .status-pending {
            background: #334155;
            color: #94a3b8;
        }

        .status-completed {
            background: #166534;
            color: #bbf7d0;
        }

        .task-description {
            font-size: 14px;
            line-height: 1.5;
            color: #cbd5e1;
        }

        .task-description pre {
            background: #0f172a;
            padding: 12px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 13px;
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #1e293b;
            border-radius: 12px;
            margin: 16px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #1e293b;
            border-bottom: 1px solid #334155;
            transition: background 0.4s ease;
        }

        .editor-title {
            font-size: 16px;
            font-weight: 600;
        }

        .editor-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .btn-hint {
            background: linear-gradient(135deg, #eab308, #ca8a04);
        }

        .btn-hint:hover {
            background: linear-gradient(135deg, #ca8a04, #a16207);
        }

        .btn-run {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        .btn-run:hover {
            background: linear-gradient(135deg, #16a34a, #15803d);
        }

        /* –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê –î–õ–Ø –ü–û–ö–ê–ó–ê –†–ï–®–ï–ù–ò–Ø */
        .btn-solution {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .btn-solution:hover {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            transform: translateY(-1px);
        }

        .btn-solution.active {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .code-editor-wrapper {
            flex: 1;
            overflow: hidden;
            transition: height 0.4s ease;
        }

        .CodeMirror {
            height: 100%;
            font-size: 14px;
        }

        .error-hints {
            padding: 16px;
            background: #1e293b;
            border-top: 1px solid #334155;
            margin: 0 16px;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .error-hint-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #ef4444;
        }

        .error-hint-item {
            font-size: 14px;
            margin-bottom: 6px;
            color: #fda4af;
        }

        .output-container {
            padding: 16px;
            background: #1e293b;
            border-top: 1px solid #334155;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .output-title {
            font-size: 16px;
            font-weight: 600;
        }

        .clear-btn {
            background: #334155;
            color: #94a3b8;
            border: none;
            padding: 4px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .clear-btn:hover {
            background: #475569;
            color: #fff;
        }

        .output-content {
            background: #0f172a;
            padding: 12px;
            border-radius: 8px;
            min-height: 100px;
            font-family: monospace;
            font-size: 13px;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-y: auto;
            max-height: 200px;
        }

        .console-success {
            color: #22c55e;
        }

        .console-error {
            color: #ef4444;
        }

        .console-info {
            color: #3b82f6;
        }

        .navigation {
            display: flex;
            padding: 16px;
            background: #1e293b;
            border-top: 1px solid #334155;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .nav-btn {
            flex: 1;
            background: #334155;
            color: #94a3b8;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .nav-btn:hover:enabled {
            background: #475569;
            color: #fff;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .prev {
            margin-right: 8px;
        }

        .next {
            margin-left: 8px;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 16px;
            transition: opacity 0.3s ease;
        }

        .modal-content {
            background: #1e293b;
            border-radius: 12px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            transform: scale(0.95);
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #334155;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 24px;
            cursor: pointer;
        }

        .close-modal:hover {
            color: #fff;
        }

        .progress-list {
            padding: 8px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .progress-item:hover {
            background: #334155;
        }

        .progress-item.active {
            background: #334155;
            border: 1px solid #3b82f6;
        }

        .progress-item.completed {
            background: #166534;
        }

        .progress-info {
            display: flex;
            flex-direction: column;
            flex: 1;
            margin-right: 10px;
        }

        .progress-title {
            font-size: 15px;
            font-weight: 500;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .progress-difficulty {
            font-size: 12px;
            margin-top: 4px;
            padding: 2px 8px;
            border-radius: 12px;
            width: fit-content;
        }

        .difficulty-easy {
            background: #166534;
            color: #bbf7d0;
        }

        .difficulty-medium {
            background: #854d0e;
            color: #fde68a;
        }

        .difficulty-hard {
            background: #991b1b;
            color: #fecaca;
        }

        .progress-status {
            font-size: 18px;
            min-width: 24px;
            text-align: center;
        }

        .status-check {
            color: #22c55e;
        }

        .status-pending {
            color: #94a3b8;
        }

        .focus-mode .app-header,
        .focus-mode .task-container,
        .focus-mode .output-container,
        .focus-mode .navigation,
        .focus-mode .error-hints {
            opacity: 0 !important;
            transform: translateY(-20px) !important;
            pointer-events: none !important;
            transition: opacity 0.4s ease, transform 0.4s ease !important;
            display: none !important;
        }

        .focus-mode .editor-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: 0;
            border-radius: 0;
            z-index: 2000;
            transform: scale(1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .focus-mode .editor-header {
            background: #0f172a;
            border-bottom: 1px solid #334155;
        }

        .focus-mode .code-editor-wrapper {
            flex: 1;
            height: calc(100vh - 60px);
        }

        .focus-mode .CodeMirror {
            height: 100%;
        }

        .focus-btn {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            margin-left: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .focus-btn:hover {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            transform: translateY(-1px);
        }

        .focus-btn.focus-active {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .exit-focus-btn {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 2001;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            opacity: 0;
            transform: scale(0.8);
        }

        .focus-mode .exit-focus-btn {
            opacity: 1;
            transform: scale(1);
        }

        .exit-focus-btn:hover {
            background: rgba(239, 68, 68, 0.9);
            transform: scale(1.1);
        }

        .modal-overlay.show {
            opacity: 1;
        }

        .modal-content.show {
            transform: scale(1);
            opacity: 1;
        }

        @media (max-width: 768px) {
            .editor-container {
                margin: 10px;
                border-radius: 12px;
            }
            
            .editor-actions {
                justify-content: space-between;
            }
            
            .btn, .btn-solution, .focus-btn {
                padding: 6px 10px;
                font-size: 12px;
                flex: 1;
                min-width: 100px;
                justify-content: center;
            }
            
            .exit-focus-btn {
                width: 45px;
                height: 45px;
                top: 10px;
                right: 10px;
            }

            .focus-mode .code-editor-wrapper {
                height: calc(100vh - 50px);
            }
            
            .modal-content {
                max-width: 90%;
            }
            
            .progress-title {
                font-size: 14px;
            }
        }

        #focusOutput {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: #1e293b;
            border-top: 1px solid #334155;
            z-index: 2002;
            overflow-y: auto;
            padding: 16px;
            color: #e2e8f0;
            font-family: monospace;
            font-size: 13px;
            display: none;
            transition: all 0.3s ease;
        }

        #focusOutput .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #334155;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        #focusOutput .close-btn:hover {
            background: #475569;
        }

        @media (max-width: 768px) {
            #focusOutput {
                height: 30vh;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #0f172a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #334155;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: #94a3b8;
            font-size: 16px;
            font-weight: 500;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            padding: 20px;
            background: #ef4444;
            color: white;
            border-radius: 8px;
            text-align: center;
            margin: 20px;
        }

        .retry-btn {
            background: white;
            color: #ef4444;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
        }

        .retry-btn:hover {
            background: #f8fafc;
        }

        .auto-next-btn {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .auto-next-btn:hover {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .auto-next-countdown {
            font-size: 12px;
            opacity: 0.8;
        }

        .progress-stats {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px;
            background: #1e293b;
            border-bottom: 1px solid #334155;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 600;
            color: #3b82f6;
        }

        .stat-label {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 4px;
        }

        .stat-value.completed {
            color: #22c55e;
        }

        .stat-value.total {
            color: #8b5cf6;
        }

        .stat-value.percent {
            color: #eab308;
        }

        .reset-progress-btn {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: 500;
            font-size: 13px;
            margin: 10px 16px;
            transition: all 0.2s;
        }

        .reset-progress-btn:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .progress-notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #3b82f6;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            z-index: 1001;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
        }

        #app {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 0;
            transition: all 0.3s ease;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #1e293b;
            border-bottom: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #1e293b;
            border-radius: 12px;
            margin: 16px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 300px;
        }

        .code-editor-wrapper {
            flex: 1;
            min-height: 200px;
        }

        .error-hints {
            padding: 16px;
            background: #1e293b;
            border-top: 1px solid #334155;
            margin: 0 16px;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .output-container {
            padding: 16px;
            background: #1e293b;
            margin: 0 16px 16px;
            border-radius: 12px;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .navigation {
            display: flex;
            padding: 16px;
            background: #1e293b;
            border-top: 1px solid #334155;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .focus-mode .app-header,
        .focus-mode .task-container,
        .focus-mode .output-container,
        .focus-mode .navigation,
        .focus-mode .error-hints {
            opacity: 0 !important;
            transform: translateY(-20px) !important;
            pointer-events: none !important;
            transition: opacity 0.4s ease, transform 0.4s ease !important;
            display: none !important;
        }

        .focus-mode .editor-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: 0;
            border-radius: 0;
            z-index: 2000;
            transform: scale(1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .focus-mode .editor-header {
            background: #0f172a;
            border-bottom: 1px solid #334155;
        }

        .focus-mode .code-editor-wrapper {
            flex: 1;
            height: calc(100vh - 60px);
        }

        .focus-mode .CodeMirror {
            height: 100%;
        }

        @media (max-width: 768px) {
            .editor-container {
                margin: 10px;
                border-radius: 12px;
            }
            
            .output-container,
            .error-hints {
                margin: 0 10px 10px;
            }
            
            .task-container {
                padding: 12px;
            }
            
            .navigation {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π...</div>
    </div>

    <div id="app" style="display: none;">
        <header class="app-header">
            <div class="header-left">
                <button class="icon-btn" id="menuBtn">‚ò∞</button>
                <div class="header-title">JS –¢—Ä–µ–Ω–∞–∂–µ—Ä</div>
            </div>
            <div class="progress-indicator">
                <span id="progressText">1/110</span>
            </div>
            <div class="header-actions">
                <button class="icon-btn" id="helpBtn">?</button>
            </div>
        </header>

        <div class="task-container" id="taskContainer">
            <div class="task-header">
                <div class="task-title" id="taskTitle">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏—è...</div>
                <div class="task-status status-pending" id="taskStatus">–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
            </div>
            <div class="task-description" id="taskDescription">
                –ó–∞–≥—Ä—É–∑–∫–∞...
            </div>
        </div>

        <div class="editor-container">
            <div class="editor-header">
                <div class="editor-actions">
                    <button class="focus-btn" id="focusBtn">
                        –§–æ–∫—É—Å
                    </button>
                    <!-- –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê –î–õ–Ø –ü–û–ö–ê–ó–ê –†–ï–®–ï–ù–ò–Ø -->
                    <button class="btn btn-solution" id="solutionBtn">
                        –†–µ—à–µ–Ω–∏–µ
                    </button>
                    <button class="btn btn-hint" id="hintBtn">
                        –ü–æ–¥—Å–∫–∞–∑–∫–∞
                    </button>
                    <button class="btn btn-run" id="runBtn">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
                </div>
            </div>
            <div class="code-editor-wrapper">
                <textarea id="codeEditor">// –ù–∞–ø–∏—à–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –∑–¥–µ—Å—å</textarea>
            </div>
        </div>

        <div class="error-hints" id="errorHints" style="display: none;">
            <div class="error-hint-title">–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏:</div>
            <div class="error-hint-item" id="hintList"></div>
        </div>

        <div class="output-container">
            <div class="output-header">
                <div class="output-title">–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                <button class="clear-btn" id="clearOutputBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
            <div class="output-content" id="output">
                –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–¥, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç...
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn prev" id="prevBtn">
                <span>‚Üê</span> –ù–∞–∑–∞–¥
            </button>
            <button class="nav-btn next" id="nextBtn">
                –í–ø–µ—Ä–µ–¥ <span>‚Üí</span>
            </button>
        </div>
    </div>

    <button class="exit-focus-btn" id="exitFocusBtn" style="display: none;">‚úï</button>

    <div id="focusOutput" style="display: none;"></div>

    <div class="modal-overlay" id="progressModal" style="display: none; opacity: 0;">
        <div class="modal-content" style="opacity: 0;">
            <div class="modal-header">
                <h2 class="modal-title">–ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è</h2>
                <button class="close-modal" id="closeModalBtn">√ó</button>
            </div>
            <div class="progress-stats" id="progressStats">
                <div class="stat-item">
                    <div class="stat-value completed" id="completedCount">0</div>
                    <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value total" id="totalCount">110</div>
                    <div class="stat-label">–í—Å–µ–≥–æ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value percent" id="percentComplete">0%</div>
                    <div class="stat-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                </div>
            </div>
            <button class="reset-progress-btn" id="resetProgressBtn">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
            <div class="progress-list" id="progressList"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/matchbrackets.min.js"></script>
    
    <script>
        // –í–°–¢–ê–í–¨–¢–ï –°–Æ–î–ê –í–ê–®–£ –°–¢–†–£–ö–¢–£–†–£ QUESTIONS_DATA –ü–†–Ø–ú–û –í –ö–û–î
        const QUESTIONS_DATA = {
            "tasks": [
                {
                    "id": 3,
                    "title": "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö",
                    "difficulty": "easy",
                    "description": "–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–µ—Ä–Ω–∏—Ç–µ –º–∞—Å—Å–∏–≤ —Å –∏—Ö —Ç–∏–ø–∞–º–∏ (–∏—Å–ø–æ–ª—å–∑—É—è –æ–ø–µ—Ä–∞—Ç–æ—Ä typeof).\n\n–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∏–ø–æ–≤: —Å—Ç—Ä–æ–∫–∞, —á–∏—Å–ª–æ, –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ, undefined, null, Symbol, BigInt, –æ–±—ä–µ–∫—Ç, –º–∞—Å—Å–∏–≤, —Ñ—É–Ω–∫—Ü–∏—è.",
                    "initialCode": "function checkTypes() {\n // –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö\n // –í–µ—Ä–Ω–∏—Ç–µ –º–∞—Å—Å–∏–≤ —Å –∏—Ö —Ç–∏–ø–∞–º–∏ —á–µ—Ä–µ–∑ typeof\n \n}",
                    "solution": "function checkTypes() {\n const str = '—Å—Ç—Ä–æ–∫–∞';\n const num = 42;\n const bool = true;\n const undef = undefined;\n const nul = null;\n const sym = Symbol('id');\n const big = 123n;\n const obj = {};\n const arr = [];\n const func = function() {};\n \n const types = [\n   typeof str, typeof num, typeof bool, typeof undef,\n   typeof nul, typeof sym, typeof big, typeof obj,\n   typeof arr, typeof func\n ];\n \n return types;\n}",
                    "hints": [
                        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ typeof –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞",
                        "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: typeof null –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 'object'",
                        "–ú–∞—Å—Å–∏–≤—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ - —Ç–æ–∂–µ –æ–±—ä–µ–∫—Ç—ã"
                    ],
                    "tests": [
                        { "code": "checkTypes()", "expected": ['string', 'number', 'boolean', 'undefined', 'object', 'symbol', 'bigint', 'object', 'object', 'function'] }
                    ],
                    "chapter": "–ß–∞—Å—Ç—å 1: –§—É–Ω–¥–∞–º–µ–Ω—Ç"
                },
                // –î–æ–±–∞–≤—å—Ç–µ –∑–¥–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –µ—Å–ª–∏ –æ–Ω–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–µ
                // –ò–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å - –¥–ª—è –∑–∞–¥–∞–Ω–∏—è ‚Ññ3 –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
            ]
        };

        const AppState = {
            currentTaskIndex: 0,
            completedTasks: new Set(),
            codeEditor: null,
            tasks: [],
            autoNextInterval: null,
            autoNextCountdown: 5,
            isSolutionVisible: false, // –ù–û–í–ê–Ø –ü–ï–†–ï–ú–ï–ù–ù–ê–Ø
            
            init() {
                try {
                    document.getElementById('loadingText').textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π...';
                    this.loadTasks();
                    this.loadProgress();
                    this.initCodeEditor();
                    this.bindEvents();
                    this.updateUI();
                    
                    setTimeout(() => {
                        document.getElementById('loadingOverlay').style.opacity = '0';
                        document.getElementById('app').style.display = 'flex';
                        setTimeout(() => {
                            document.getElementById('loadingOverlay').style.display = 'none';
                        }, 500);
                    }, 500);
                    
                } catch (error) {
                    this.showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π', error);
                }
            },
            
            loadTasks() {
                try {
                    if (typeof QUESTIONS_DATA !== 'undefined' && QUESTIONS_DATA.tasks) {
                        this.tasks = QUESTIONS_DATA.tasks;
                        console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${this.tasks.length} –∑–∞–¥–∞–Ω–∏–π`);
                    } else {
                        throw new Error('QUESTIONS_DATA –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    }
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π:', error);
                    this.showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π', error);
                }
            },
            
            loadProgress() {
                const saved = localStorage.getItem('jsTrainerProgress');
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        this.completedTasks = new Set(data.completedTasks || []);
                        
                        if (data.currentTaskIndex !== undefined && data.currentTaskIndex !== null) {
                            this.currentTaskIndex = Math.min(
                                Math.max(0, data.currentTaskIndex), 
                                this.tasks.length - 1
                            );
                            
                            this.showProgressNotification();
                        } else {
                            this.currentTaskIndex = 0;
                        }
                        
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', e);
                        this.completedTasks = new Set();
                        this.currentTaskIndex = 0;
                    }
                } else {
                    this.currentTaskIndex = 0;
                    this.completedTasks = new Set();
                }
                
                console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å: —Ç–µ–∫—É—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ ${this.currentTaskIndex + 1}, –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${this.completedTasks.size}`);
            },
            
            showProgressNotification() {
                const completedCount = this.completedTasks.size;
                const notification = document.createElement('div');
                notification.className = 'progress-notification';
                notification.innerHTML = `
                    <div>–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∂–µ–Ω! –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${completedCount}/${this.tasks.length} –∑–∞–¥–∞–Ω–∏–π</div>
                    <div style="font-size: 12px; opacity: 0.8;">–ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –ø—Ä–æ–π–¥–µ–Ω–Ω–æ–º—É –∑–∞–¥–∞–Ω–∏—é</div>
                `;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(-50%) translateY(20px)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            },
            
            saveProgress() {
                const data = {
                    currentTaskIndex: this.currentTaskIndex,
                    completedTasks: Array.from(this.completedTasks),
                    lastSave: new Date().toISOString()
                };
                localStorage.setItem('jsTrainerProgress', JSON.stringify(data));
            },
            
            resetProgress() {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                    this.currentTaskIndex = 0;
                    this.completedTasks = new Set();
                    localStorage.removeItem('jsTrainerProgress');
                    this.updateUI();
                    this.updateProgressModal();
                    
                    const notification = document.createElement('div');
                    notification.className = 'progress-notification';
                    notification.style.background = '#22c55e';
                    notification.textContent = '–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω! –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.';
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateX(-50%) translateY(20px)';
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.parentNode.removeChild(notification);
                            }
                        }, 300);
                    }, 3000);
                }
            },
            
            initCodeEditor() {
                this.codeEditor = CodeMirror.fromTextArea(document.getElementById('codeEditor'), {
                    mode: "javascript",
                    theme: "monokai",
                    lineNumbers: true,
                    lineWrapping: true,
                    matchBrackets: true,
                    autoCloseBrackets: true,
                    extraKeys: {
                        "Ctrl-Space": "autocomplete",
                        "Ctrl-Enter": () => this.runCode(),
                        "F11": () => this.toggleFocusMode(),
                        "Ctrl-H": () => this.toggleSolution() // –ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞
                    },
                    viewportMargin: Infinity
                });
                
                this.codeEditor.setSize('100%', '100%');
            },
            
            toggleFocusMode() {
                const app = document.getElementById('app');
                const exitFocusBtn = document.getElementById('exitFocusBtn');
                const focusBtn = document.getElementById('focusBtn');
                
                if (app.classList.contains('focus-mode')) {
                    app.classList.remove('focus-mode');
                    exitFocusBtn.style.display = 'none';
                    focusBtn.classList.remove('focus-active');
                    focusBtn.innerHTML = '<span>üîç</span> –§–æ–∫—É—Å';
                } else {
                    app.classList.add('focus-mode');
                    exitFocusBtn.style.display = 'flex';
                    focusBtn.classList.add('focus-active');
                    focusBtn.innerHTML = '<span>üì±</span> –í —Ñ–æ–∫—É—Å–µ';
                }
                
                setTimeout(() => {
                    this.codeEditor.refresh();
                }, 400);
            },
            
            bindEvents() {
                document.getElementById('prevBtn').addEventListener('click', () => this.prevTask());
                document.getElementById('nextBtn').addEventListener('click', () => this.nextTask());
                
                document.getElementById('runBtn').addEventListener('click', () => this.runCode());
                document.getElementById('hintBtn').addEventListener('click', () => this.showHint());
                document.getElementById('clearOutputBtn').addEventListener('click', () => this.clearOutput());
                document.getElementById('solutionBtn').addEventListener('click', () => this.toggleSolution()); // –ù–û–í–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö
                
                document.getElementById('menuBtn').addEventListener('click', () => this.showProgressModal());
                document.getElementById('closeModalBtn').addEventListener('click', () => this.hideProgressModal());
                document.getElementById('helpBtn').addEventListener('click', () => this.showHelp());
                
                document.getElementById('resetProgressBtn').addEventListener('click', () => this.resetProgress());
                
                document.getElementById('focusBtn').addEventListener('click', () => this.toggleFocusMode());
                document.getElementById('exitFocusBtn').addEventListener('click', () => this.toggleFocusMode());
                
                document.getElementById('progressModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('progressModal')) {
                        this.hideProgressModal();
                    }
                });
                
                window.addEventListener('resize', () => {
                    setTimeout(() => {
                        if (this.codeEditor) {
                            this.codeEditor.refresh();
                        }
                    }, 100);
                });
                
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && document.getElementById('app').classList.contains('focus-mode')) {
                        this.toggleFocusMode();
                    }
                });
            },
            
            updateUI(keepCode = false) {
                if (this.tasks.length === 0) {
                    this.showError('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π');
                    return;
                }
                
                const task = this.tasks[this.currentTaskIndex];
                
                document.getElementById('taskTitle').textContent = `${task.id}. ${task.title}`;
                document.getElementById('taskDescription').innerHTML = `<p>${task.description}</p>`;
                
                this.updateTaskStatus();
                
                if (!keepCode) {
                    this.isSolutionVisible = false;
                    this.codeEditor.setValue(task.initialCode);
                    this.updateSolutionButton();
                }
                
                document.getElementById('progressText').textContent = 
                    `${this.currentTaskIndex + 1}/${this.tasks.length}`;
                
                document.getElementById('prevBtn').disabled = this.currentTaskIndex === 0;
                document.getElementById('nextBtn').disabled = this.currentTaskIndex === this.tasks.length - 1;
                
                this.updateProgressModal();
                document.getElementById('errorHints').style.display = 'none';
                this.clearOutput();
                
                this.clearAutoNextTimer();
                this.saveProgress();
                
                setTimeout(() => {
                    this.codeEditor.refresh();
                }, 10);
            },
            
            // –ù–û–í–´–ô –ú–ï–¢–û–î –î–õ–Ø –ü–û–ö–ê–ó–ê/–°–ö–†–´–¢–ò–Ø –†–ï–®–ï–ù–ò–Ø
            toggleSolution() {
                if (this.tasks.length === 0) return;
                
                const task = this.tasks[this.currentTaskIndex];
                this.isSolutionVisible = !this.isSolutionVisible;
                
                if (this.isSolutionVisible) {
                    // –°–æ–∑–¥–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –Ω–∞ –ª–µ—Ç—É
                    const solutionWithComments = this.createSolutionWithComments(task);
                    this.codeEditor.setValue(solutionWithComments);
                } else {
                    this.codeEditor.setValue(task.initialCode);
                }
                
                this.updateSolutionButton();
                this.codeEditor.refresh();
            },
            
            // –ù–û–í–´–ô –ú–ï–¢–û–î –î–õ–Ø –°–û–ó–î–ê–ù–ò–Ø –†–ï–®–ï–ù–ò–Ø –° –ö–û–ú–ú–ï–ù–¢–ê–†–ò–Ø–ú–ò
            createSolutionWithComments(task) {
                if (task.id === 3) {
                    // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è ‚Ññ3
                    return `function checkTypes() {
 // –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
 const str = '—Å—Ç—Ä–æ–∫–∞'; // –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏
 const num = 42; // –ü—Ä–∏–º–µ—Ä —á–∏—Å–ª–∞
 const bool = true; // –ü—Ä–∏–º–µ—Ä –±—É–ª–µ–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è
 const undef = undefined; // –ü—Ä–∏–º–µ—Ä undefined
 const nul = null; // –ü—Ä–∏–º–µ—Ä null (–±—É–¥–µ—Ç 'object' —á–µ—Ä–µ–∑ typeof)
 const sym = Symbol('id'); // –ü—Ä–∏–º–µ—Ä Symbol
 const big = 123n; // –ü—Ä–∏–º–µ—Ä BigInt
 const obj = {}; // –ü—Ä–∏–º–µ—Ä –æ–±—ä–µ–∫—Ç–∞
 const arr = []; // –ü—Ä–∏–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ (–±—É–¥–µ—Ç 'object' —á–µ—Ä–µ–∑ typeof)
 const func = function() {}; // –ü—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏
 
 // –í–µ—Ä–Ω–∏—Ç–µ –º–∞—Å—Å–∏–≤ —Å –∏—Ö —Ç–∏–ø–∞–º–∏ —á–µ—Ä–µ–∑ typeof
 const types = [
   typeof str, typeof num, typeof bool, typeof undef,
   typeof nul, typeof sym, typeof big, typeof obj,
   typeof arr, typeof func
 ];
 
 return types;
}`;
                }
                
                // –î–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞–Ω–∏–π –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                // –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–π –ø–æ–¥—Ö–æ–¥
                return task.solution + "\n\n// –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ. –ò–∑—É—á–∏—Ç–µ –µ–≥–æ, –∑–∞—Ç–µ–º –∑–∞–∫—Ä–æ–π—Ç–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–µ—à–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.";
            },
            
            // –ù–û–í–´–ô –ú–ï–¢–û–î –î–õ–Ø –û–ë–ù–û–í–õ–ï–ù–ò–Ø –ö–ù–û–ü–ö–ò
            updateSolutionButton() {
                const solutionBtn = document.getElementById('solutionBtn');
                if (this.isSolutionVisible) {
                    solutionBtn.classList.add('active');
                    solutionBtn.innerHTML = '–°–∫—Ä—ã—Ç—å —Ä–µ—à–µ–Ω–∏–µ';
                } else {
                    solutionBtn.classList.remove('active');
                    solutionBtn.innerHTML = '–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ';
                }
            },
            
            clearAutoNextTimer() {
                if (this.autoNextInterval) {
                    clearInterval(this.autoNextInterval);
                    this.autoNextInterval = null;
                }
                this.autoNextCountdown = 5;
            },
            
            updateTaskStatus() {
                const task = this.tasks[this.currentTaskIndex];
                const statusElement = document.getElementById('taskStatus');
                if (this.completedTasks.has(task.id)) {
                    statusElement.textContent = '–í—ã–ø–æ–ª–Ω–µ–Ω–æ';
                    statusElement.className = 'task-status status-completed';
                } else {
                    statusElement.textContent = '–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ';
                    statusElement.className = 'task-status status-pending';
                }
            },
            
            prevTask() {
                if (this.currentTaskIndex > 0) {
                    this.currentTaskIndex--;
                    this.updateUI();
                }
            },
            
            nextTask() {
                if (this.currentTaskIndex < this.tasks.length - 1) {
                    this.currentTaskIndex++;
                    this.updateUI();
                }
            },
            
            runCode() {
                if (this.tasks.length === 0) return;
                
                const app = document.getElementById('app');
                const isFocus = app.classList.contains('focus-mode');
                const task = this.tasks[this.currentTaskIndex];
                const userCode = this.codeEditor.getValue();
                const normalOutput = document.getElementById('output');
                const normalErrorHints = document.getElementById('errorHints');
                const focusOutput = document.getElementById('focusOutput');
                const outputElement = isFocus ? focusOutput : normalOutput;
                const hintListElement = isFocus ? focusOutput : document.getElementById('hintList');
                
                outputElement.innerHTML = '';
                if (!isFocus) {
                    normalErrorHints.style.display = 'none';
                }
                hintListElement.innerHTML = '';
                
                if (isFocus) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'close-btn';
                    closeBtn.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
                    closeBtn.onclick = () => {
                        focusOutput.style.display = 'none';
                        this.toggleFocusMode();
                    };
                    outputElement.appendChild(closeBtn);
                    focusOutput.style.display = 'block';
                }
                
                try {
                    const originalLog = console.log;
                    const originalError = console.error;
                    const outputLogs = [];
                    
                    console.log = function(...args) {
                        outputLogs.push({ type: 'log', message: args.join(' ') });
                        originalLog.apply(console, args);
                    };
                    
                    console.error = function(...args) {
                        outputLogs.push({ type: 'error', message: args.join(' ') });
                        originalError.apply(console, args);
                    };
                    
                    eval(userCode);
                    
                    console.log = originalLog;
                    console.error = originalError;
                    
                    let allTestsPassed = true;
                    const testResults = [];
                    
                    for (const test of task.tests) {
                        try {
                            const result = eval(test.code);
                            const isPassed = JSON.stringify(result) === JSON.stringify(test.expected);
                            
                            if (!isPassed) {
                                allTestsPassed = false;
                            }
                            
                            testResults.push({
                                test: test.code,
                                result,
                                expected: test.expected,
                                passed: isPassed
                            });
                        } catch (error) {
                            allTestsPassed = false;
                            testResults.push({
                                test: test.code,
                                error: error.message,
                                passed: false
                            });
                        }
                    }
                    
                    testResults.forEach((testResult, index) => {
                        const div = document.createElement('div');
                        
                        if (testResult.passed) {
                            div.className = 'console-success';
                            div.innerHTML = `‚úì –¢–µ—Å—Ç ${index + 1}: ${testResult.test} = ${JSON.stringify(testResult.result)}`;
                        } else {
                            div.className = 'console-error';
                            if (testResult.error) {
                                div.innerHTML = `‚úó –¢–µ—Å—Ç ${index + 1}: ${testResult.test} - –û—à–∏–±–∫–∞: ${testResult.error}`;
                            } else {
                                div.innerHTML = `‚úó –¢–µ—Å—Ç ${index + 1}: ${testResult.test}<br>–û–∂–∏–¥–∞–ª–æ—Å—å: ${JSON.stringify(testResult.expected)}, –ü–æ–ª—É—á–µ–Ω–æ: ${JSON.stringify(testResult.result)}`;
                            }
                        }
                        
                        outputElement.appendChild(div);
                    });
                    
                    outputLogs.forEach(log => {
                        const div = document.createElement('div');
                        div.className = `console-${log.type}`;
                        div.textContent = log.message;
                        outputElement.appendChild(div);
                    });
                    
                    if (allTestsPassed) {
                        const successDiv = document.createElement('div');
                        successDiv.className = 'console-success';
                        successDiv.innerHTML = 'üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!';
                        outputElement.insertBefore(successDiv, outputElement.firstChild);
                        
                        this.completedTasks.add(task.id);
                        this.saveProgress();
                        this.updateTaskStatus();
                        this.updateProgressModal();
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∫–∞–∑ —Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
                        this.isSolutionVisible = false;
                        this.updateSolutionButton();
                        
                        if (this.currentTaskIndex < this.tasks.length - 1) {
                            this.showAutoNextButton(outputElement, isFocus);
                        } else {
                            const finalDiv = document.createElement('div');
                            finalDiv.className = 'console-success';
                            finalDiv.innerHTML = 'üèÜ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è!';
                            finalDiv.style.fontSize = '16px';
                            finalDiv.style.fontWeight = 'bold';
                            finalDiv.style.marginTop = '15px';
                            outputElement.appendChild(finalDiv);
                        }
                        
                    } else {
                        this.showErrorHints(userCode, null, isFocus);
                    }
                    
                } catch (error) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'console-error';
                    errorDiv.innerHTML = `–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ${error.message}`;
                    outputElement.appendChild(errorDiv);
                    
                    this.showErrorHints(userCode, error, isFocus);
                }
                
                if (!isFocus) {
                    normalOutput.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else {
                    focusOutput.scrollTop = focusOutput.scrollHeight;
                }
            },
            
            showAutoNextButton(outputElement, isFocus) {
                const buttonContainer = document.createElement('div');
                buttonContainer.style.marginTop = '15px';
                buttonContainer.style.paddingTop = '15px';
                buttonContainer.style.borderTop = '1px solid #334155';
                
                const autoNextBtn = document.createElement('button');
                autoNextBtn.className = 'auto-next-btn';
                autoNextBtn.innerHTML = `
                    <span>üöÄ</span> –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∑–∞–¥–∞–Ω–∏—é
                    <span class="auto-next-countdown" id="autoNextCountdown">(5)</span>
                `;
                
                const countdownElement = autoNextBtn.querySelector('.auto-next-countdown');
                
                autoNextBtn.addEventListener('click', () => {
                    this.clearAutoNextTimer();
                    this.nextTask();
                    if (isFocus) {
                        this.exitFocusMode();
                    }
                });
                
                buttonContainer.appendChild(autoNextBtn);
                outputElement.appendChild(buttonContainer);
                
                this.startAutoNextTimer(countdownElement, isFocus);
            },
            
            startAutoNextTimer(countdownElement, isFocus) {
                this.autoNextCountdown = 5;
                
                this.autoNextInterval = setInterval(() => {
                    this.autoNextCountdown--;
                    countdownElement.textContent = `(${this.autoNextCountdown})`;
                    
                    if (this.autoNextCountdown <= 0) {
                        this.clearAutoNextTimer();
                        this.nextTask();
                        if (isFocus) {
                            this.exitFocusMode();
                        }
                    }
                }, 1000);
            },
            
            exitFocusMode() {
                const app = document.getElementById('app');
                const exitFocusBtn = document.getElementById('exitFocusBtn');
                const focusBtn = document.getElementById('focusBtn');
                const focusOutput = document.getElementById('focusOutput');
                
                app.classList.remove('focus-mode');
                exitFocusBtn.style.display = 'none';
                focusBtn.classList.remove('focus-active');
                focusBtn.innerHTML = '<span>üîç</span> –§–æ–∫—É—Å';
                focusOutput.style.display = 'none';
                
                setTimeout(() => {
                    this.codeEditor.refresh();
                }, 400);
            },
            
            showErrorHints(code, error = null, isFocus = false) {
                const hints = [];
                const lines = code.split('\n');
                
                const brackets = { '(': 0, ')': 0, '{': 0, '}': 0, '[': 0, ']': 0 };
                for (let i = 0; i < code.length; i++) {
                    if (brackets.hasOwnProperty(code[i])) {
                        brackets[code[i]]++;
                    }
                }
                
                if (brackets['('] !== brackets[')']) {
                    hints.push(`–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫—Ä—É–≥–ª—ã–µ —Å–∫–æ–±–∫–∏: –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏—Ö - ${brackets['(']}, –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö - ${brackets[')']}`);
                }
                if (brackets['{'] !== brackets['}']) {
                    hints.push(`–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏: –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏—Ö - ${brackets['{']}, –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö - ${brackets['}']}`);
                }
                if (brackets['['] !== brackets[']']) {
                    hints.push(`–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏: –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏—Ö - ${brackets['[']}, –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö - ${brackets[']']}`);
                }
                
                const functionRegex = /function\s+\w+\s*\([^)]*\)\s*{[\s\S]*?}/g;
                const matches = code.match(functionRegex);
                if (matches) {
                    matches.forEach((func, index) => {
                        if (!func.includes('return')) {
                            hints.push(`–§—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ return`);
                        }
                    });
                }
                
                const commonErrors = [
                    { pattern: /consol\./, suggestion: '–í–æ–∑–º–æ–∂–Ω–æ –æ–ø–µ—á–∞—Ç–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å console.' },
                    { pattern: /fuction/, suggestion: '–í–æ–∑–º–æ–∂–Ω–æ –æ–ø–µ—á–∞—Ç–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å function' },
                    { pattern: /retun/, suggestion: '–í–æ–∑–º–æ–∂–Ω–æ –æ–ø–µ—á–∞—Ç–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å return' },
                    { pattern: /retern/, suggestion: '–í–æ–∑–º–æ–∂–Ω–æ –æ–ø–µ—á–∞—Ç–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å return' },
                    { pattern: /\.lenght/, suggestion: '–í–æ–∑–º–æ–∂–Ω–æ –æ–ø–µ—á–∞—Ç–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å .length' }
                ];
                
                commonErrors.forEach(errorCheck => {
                    if (errorCheck.pattern.test(code)) {
                        hints.push(errorCheck.suggestion);
                    }
                });
                
                if (error) {
                    hints.push(`–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`);
                }
                
                if (hints.length > 0) {
                    const outputElement = isFocus ? document.getElementById('focusOutput') : document.getElementById('errorHints');
                    const hintListElement = isFocus ? outputElement : document.getElementById('hintList');
                    
                    if (isFocus) {
                        const hintsDiv = document.createElement('div');
                        hintsDiv.className = 'error-hints';
                        hintsDiv.innerHTML = '<div class="error-hint-title">–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏:</div>' + hints.map(hint => 
                            `<div class="error-hint-item">‚Ä¢ ${hint}</div>`
                        ).join('');
                        outputElement.appendChild(hintsDiv);
                    } else {
                        hintListElement.innerHTML = hints.map(hint => 
                            `<div class="error-hint-item">‚Ä¢ ${hint}</div>`
                        ).join('');
                        outputElement.style.display = 'block';
                        outputElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }
            },
            
            showHint() {
                if (this.tasks.length === 0) return;
                
                const app = document.getElementById('app');
                const isFocus = app.classList.contains('focus-mode');
                const task = this.tasks[this.currentTaskIndex];
                const outputElement = isFocus ? document.getElementById('focusOutput') : document.getElementById('output');
                
                outputElement.innerHTML = `
                    <div class="console-info">
                        <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è "${task.title}":</strong>
                        <br><br>
                        ${task.hints.map((hint, index) => 
                            `${index + 1}. ${hint}`
                        ).join('<br>')}
                    </div>
                `;
                
                if (isFocus) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'close-btn';
                    closeBtn.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
                    closeBtn.onclick = () => {
                        outputElement.style.display = 'none';
                        this.toggleFocusMode();
                    };
                    outputElement.appendChild(closeBtn);
                    outputElement.style.display = 'block';
                    outputElement.scrollTop = outputElement.scrollHeight;
                } else {
                    outputElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            },
            
            clearOutput() {
                document.getElementById('output').innerHTML = '–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–¥, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç...';
                document.getElementById('errorHints').style.display = 'none';
                const focusOutput = document.getElementById('focusOutput');
                focusOutput.style.display = 'none';
                focusOutput.innerHTML = '';
            },
            
            showProgressModal() {
                const modal = document.getElementById('progressModal');
                const content = modal.querySelector('.modal-content');
                modal.style.display = 'flex';
                setTimeout(() => {
                    modal.classList.add('show');
                    content.classList.add('show');
                }, 10);
                this.updateProgressModal();
            },
            
            hideProgressModal() {
                const modal = document.getElementById('progressModal');
                const content = modal.querySelector('.modal-content');
                modal.classList.remove('show');
                content.classList.remove('show');
                setTimeout(() => {
                    modal.style.display = 'none';
                }, 300);
            },
            
            updateProgressModal() {
                const progressList = document.getElementById('progressList');
                const completedCount = this.completedTasks.size;
                const totalCount = this.tasks.length;
                const percent = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
                
                document.getElementById('completedCount').textContent = completedCount;
                document.getElementById('totalCount').textContent = totalCount;
                document.getElementById('percentComplete').textContent = `${percent}%`;
                
                progressList.innerHTML = '';
                
                this.tasks.forEach((task, index) => {
                    const item = document.createElement('div');
                    item.className = `progress-item ${index === this.currentTaskIndex ? 'active' : ''} ${this.completedTasks.has(task.id) ? 'completed' : ''}`;
                    item.dataset.index = index;
                    
                    item.innerHTML = `
                        <div class="progress-info">
                            <div class="progress-title">${task.id}. ${task.title}</div>
                            <div class="progress-difficulty difficulty-${task.difficulty}">
                                ${task.difficulty === 'easy' ? '–õ–µ–≥–∫–æ' : task.difficulty === 'medium' ? '–°—Ä–µ–¥–Ω–µ' : '–°–ª–æ–∂–Ω–æ'}
                            </div>
                        </div>
                        <div class="progress-status ${this.completedTasks.has(task.id) ? 'status-check' : 'status-pending'}">
                            ${this.completedTasks.has(task.id) ? '‚úì' : '‚óã'}
                        </div>
                    `;
                    
                    item.addEventListener('click', () => {
                        this.currentTaskIndex = index;
                        this.hideProgressModal();
                        this.updateUI();
                    });
                    
                    progressList.appendChild(item);
                });
                
                const activeItem = progressList.querySelector('.progress-item.active');
                if (activeItem) {
                    setTimeout(() => {
                        activeItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 100);
                }
            },
            
            showHelp() {
                const app = document.getElementById('app');
                const isFocus = app.classList.contains('focus-mode');
                const outputElement = isFocus ? document.getElementById('focusOutput') : document.getElementById('output');
                const completedCount = this.completedTasks.size;
                const totalCount = this.tasks.length;
                const percent = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
                
                outputElement.innerHTML = `
                    <div class="console-info">
                        <strong>–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞:</strong>
                        <br><br>
                        1. <strong>–ó–∞–¥–∞–Ω–∏—è:</strong> –†–µ—à–∞–π—Ç–µ –∑–∞–¥–∞—á–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É –∏–ª–∏ –≤—ã–±–∏—Ä–∞–π—Ç–µ –≤ –º–µ–Ω—é
                        <br><br>
                        2. <strong>–†–µ–¥–∞–∫—Ç–æ—Ä:</strong> –ü–∏—à–∏—Ç–µ –∫–æ–¥ JavaScript, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Tab –¥–ª—è –æ—Ç—Å—Ç—É–ø–æ–≤
                        <br><br>
                        3. <strong>–†–µ–∂–∏–º —Ñ–æ–∫—É—Å–∞:</strong> –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–§–æ–∫—É—Å" –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                        <br><br>
                        4. <strong>–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ:</strong> –ù–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ" —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∫–æ–¥ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
                        <br><br>
                        5. <strong>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:</strong> –ù–∞–∂–º–∏—Ç–µ "–í—ã–ø–æ–ª–Ω–∏—Ç—å" —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ
                        <br><br>
                        6. <strong>–¢–µ—Å—Ç—ã:</strong> –†–µ—à–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º, –µ—Å–ª–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã
                        <br><br>
                        7. <strong>–ü—Ä–æ–≥—Ä–µ—Å—Å:</strong> –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
                        <br><br>
                        8. <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∏:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥—Å–∫–∞–∑–∫–∞" –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏
                        <br><br>
                        9. <strong>–ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥:</strong> –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥)
                        <br><br>
                        10. <strong>–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å:</strong> –í—ã–ø–æ–ª–Ω–µ–Ω–æ ${completedCount} –∏–∑ ${totalCount} –∑–∞–¥–∞–Ω–∏–π (${percent}%)
                        <br><br>
                        <em>–°–æ–≤–µ—Ç:</em> –î–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ä–µ–∂–∏–º–∞ —Ñ–æ–∫—É—Å–∞ –Ω–∞–∂–º–∏—Ç–µ –∫—Ä–µ—Å—Ç–∏–∫ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –∏–ª–∏ –∫–ª–∞–≤–∏—à—É Escape.
                        <br><br>
                        <em>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:</em> Ctrl+Enter - –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥, Ctrl+H - –ø–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Ä–µ—à–µ–Ω–∏–µ
                    </div>
                `;
                
                if (isFocus) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'close-btn';
                    closeBtn.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
                    closeBtn.onclick = () => {
                        outputElement.style.display = 'none';
                        this.toggleFocusMode();
                    };
                    outputElement.appendChild(closeBtn);
                    outputElement.style.display = 'block';
                    outputElement.scrollTop = outputElement.scrollHeight;
                } else {
                    outputElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            },
            
            showError(message, error = null) {
                const loadingOverlay = document.getElementById('loadingOverlay');
                loadingOverlay.innerHTML = `
                    <div class="error-message">
                        <h3>${message}</h3>
                        ${error ? `<p>${error.message}</p>` : ''}
                        <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ questions.js</p>
                        <button class="retry-btn" id="retryBtn">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É</button>
                    </div>
                `;
                
                document.getElementById('retryBtn').addEventListener('click', () => {
                    window.location.reload();
                });
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            AppState.init();
        });
    </script>
</body>
</html>